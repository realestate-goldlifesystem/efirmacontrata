<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Life System - Formulario de Arrendamiento</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold-primary: #FFD700;
            --gold-dark: #B8860B;
            --gold-light: #FFF8DC;
            --black-primary: #0F0F0F;
            --black-secondary: #1A1A1A;
            --gray-dark: #2D2D2D;
            --gray-medium: #404040;
            --white: #FFFFFF;
            --success: #059669;
            --error: #DC2626;
            --info: #2563EB;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--black-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Partículas doradas de fondo */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--gold-primary);
            border-radius: 50%;
            opacity: 0;
            animation: floatUp 15s infinite;
            box-shadow: 0 0 6px var(--gold-primary);
        }

        @keyframes floatUp {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0);
            }
            10% {
                opacity: 1;
                transform: translateY(90vh) scale(1);
            }
            90% {
                opacity: 1;
                transform: translateY(10vh) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(0) scale(0);
            }
        }

        /* Contenedor principal */
        .main-container {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* Card principal con efecto de luz */
        .form-card {
            width: 100%;
            max-width: 900px;
            background: linear-gradient(135deg, var(--black-secondary) 0%, var(--gray-dark) 100%);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 
                0 0 50px rgba(255, 215, 0, 0.1),
                0 0 100px rgba(255, 215, 0, 0.05),
                inset 0 0 2px rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.2);
            animation: levitate 3s ease-in-out infinite;
        }

        @keyframes levitate {
            0%, 100% {
                transform: translateY(0);
                box-shadow: 
                    0 0 50px rgba(255, 215, 0, 0.1),
                    0 0 100px rgba(255, 215, 0, 0.05),
                    inset 0 0 2px rgba(255, 215, 0, 0.1);
            }
            50% {
                transform: translateY(-10px);
                box-shadow: 
                    0 10px 60px rgba(255, 215, 0, 0.15),
                    0 20px 120px rgba(255, 215, 0, 0.08),
                    inset 0 0 2px rgba(255, 215, 0, 0.1);
            }
        }

        /* Header del formulario */
        .form-header {
            background: linear-gradient(135deg, var(--gold-dark) 0%, var(--gold-primary) 100%);
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .form-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .logo {
            font-size: 36px;
            font-weight: bold;
            color: var(--black-primary);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .tagline {
            color: var(--black-secondary);
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        /* Progress bar */
        .progress-container {
            padding: 30px;
            background: var(--gray-dark);
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gray-medium);
            z-index: 1;
        }

        .progress-line-active {
            position: absolute;
            top: 20px;
            left: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--gold-dark), var(--gold-primary));
            z-index: 2;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--gold-primary);
        }

        .step {
            position: relative;
            z-index: 3;
            text-align: center;
            flex: 1;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            margin: 0 auto 10px;
            border-radius: 50%;
            background: var(--gray-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-dark);
            font-weight: bold;
            transition: all 0.3s ease;
            border: 2px solid var(--gray-medium);
        }

        .step.active .step-circle {
            background: var(--gold-primary);
            color: var(--black-primary);
            border-color: var(--gold-primary);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: pulse 2s infinite;
        }

        .step.completed .step-circle {
            background: var(--success);
            color: var(--white);
            border-color: var(--success);
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .step-label {
            font-size: 12px;
            color: var(--gray-medium);
            transition: color 0.3s ease;
        }

        .step.active .step-label,
        .step.completed .step-label {
            color: var(--gold-primary);
        }

        /* Contenido del formulario */
        .form-content {
            padding: 40px;
            min-height: 400px;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .step-title {
            color: var(--gold-primary);
            font-size: 24px;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
        }

        /* Campos del formulario */
        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        label {
            display: block;
            color: var(--gold-light);
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .required {
            color: var(--gold-primary);
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px 15px;
            background: var(--black-primary);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 8px;
            color: var(--white);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--gold-primary);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
        }

        input::placeholder {
            color: var(--gray-medium);
        }

        /* File upload estilizado */
        .file-upload-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-upload-label {
            display: block;
            padding: 12px 15px;
            background: linear-gradient(135deg, var(--gray-dark) 0%, var(--black-primary) 100%);
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            color: var(--gold-light);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-label:hover {
            border-color: var(--gold-primary);
            background: linear-gradient(135deg, var(--black-primary) 0%, var(--gray-dark) 100%);
        }

        .file-upload-input {
            position: absolute;
            left: -9999px;
        }

        .file-selected {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--gold-primary);
        }

        /* Botones */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 40px;
            background: var(--gray-dark);
            border-top: 1px solid rgba(255, 215, 0, 0.1);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-prev {
            background: var(--gray-medium);
            color: var(--white);
        }

        .btn-prev:hover {
            background: var(--gray-dark);
            transform: translateX(-5px);
        }

        .btn-next,
        .btn-submit {
            background: linear-gradient(135deg, var(--gold-dark) 0%, var(--gold-primary) 100%);
            color: var(--black-primary);
            position: relative;
            overflow: hidden;
        }

        .btn-next::before,
        .btn-submit::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .btn-next:hover::before,
        .btn-submit:hover::before {
            left: 100%;
        }

        .btn-next:hover,
        .btn-submit:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Modal de pago */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--black-secondary);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.2);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-title {
            color: var(--gold-primary);
            font-size: 24px;
            margin-bottom: 10px;
        }

        .payment-amount {
            font-size: 36px;
            color: var(--white);
            font-weight: bold;
            margin: 20px 0;
        }

        .payment-method {
            background: var(--gray-dark);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .payment-method h3 {
            color: var(--gold-primary);
            margin-bottom: 15px;
        }

        .nequi-number {
            font-size: 28px;
            color: var(--white);
            text-align: center;
            padding: 15px;
            background: var(--black-primary);
            border-radius: 8px;
            margin: 10px 0;
            letter-spacing: 2px;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 30px;
            color: var(--gray-medium);
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--gold-primary);
        }

        /* Mensajes de validación */
        .validation-message {
            margin-top: 5px;
            font-size: 12px;
            display: none;
        }

        .validation-message.show {
            display: block;
        }

        .validation-message.success {
            color: var(--success);
        }

        .validation-message.error {
            color: var(--error);
        }

        /* Loading overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--gray-dark);
            border-top: 3px solid var(--gold-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--gold-primary);
            margin-top: 20px;
            font-size: 18px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .form-card {
                margin: 10px;
            }

            .form-content {
                padding: 20px;
            }

            .step-label {
                display: none;
            }

            .form-navigation {
                padding: 20px;
            }

            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        /* Animación de entrada */
        .animate-in {
            animation: slideInUp 0.5s ease forwards;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Codeudor section */
        .codeudor-section {
            background: var(--black-primary);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .codeudor-header {
            color: var(--gold-primary);
            margin-bottom: 15px;
            font-size: 18px;
        }

        /* Success checkmark */
        .success-checkmark {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            display: none;
        }

        .success-checkmark.show {
            display: block;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <!-- Partículas de fondo -->
    <div class="particles" id="particles"></div>

    <!-- Contenedor principal -->
    <div class="main-container">
        <div class="form-card">
            <!-- Header -->
            <div class="form-header">
                <div class="logo">GOLD LIFE SYSTEM</div>
                <div class="tagline">Sistema Premium de Gestión Inmobiliaria</div>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-line"></div>
                    <div class="progress-line-active" id="progressLineActive" style="width: 0%"></div>
                    
                    <div class="step active" data-step="1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Documentos</div>
                    </div>
                    
                    <div class="step" data-step="2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Información</div>
                    </div>
                    
                    <div class="step" data-step="3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Identidad</div>
                    </div>
                    
                    <div class="step" data-step="4">
                        <div class="step-circle">4</div>
                        <div class="step-label">Codeudores</div>
                    </div>
                    
                    <div class="step" data-step="5">
                        <div class="step-circle">5</div>
                        <div class="step-label">Confirmación</div>
                    </div>
                </div>
            </div>

            <!-- Contenido del formulario -->
            <div class="form-content">
                <!-- Paso 1: Documentos Iniciales -->
                <div class="form-step active" data-step="1">
                    <h2 class="step-title">Documentos Iniciales</h2>
                    
                    <div class="form-group">
                        <button type="button" class="btn btn-next" onclick="mostrarModalPago()" style="width: 100%;">
                            REALIZAR PAGO DE DERECHOS DE CONTRATO
                        </button>
                        <p style="color: var(--gray-medium); text-align: center; margin-top: 10px;">
                            Valor: $60.000 COP
                        </p>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Documento Estudio Aprobado <span class="required">*</span></label>
                            <div class="file-upload-wrapper">
                                <label class="file-upload-label" for="estudioAprobado" id="labelEstudioAprobado">
                                    Seleccionar archivo
                                </label>
                                <input type="file" id="estudioAprobado" class="file-upload-input" accept="image/*,.pdf" required>
                            </div>
                            <div class="validation-message" id="validEstudioAprobado"></div>
                        </div>
                        
                        <div class="form-group">
                            <label>Comprobante de Pago <span class="required">*</span></label>
                            <div class="file-upload-wrapper">
                                <label class="file-upload-label" for="comprobantePago" id="labelComprobantePago">
                                    Seleccionar archivo
                                </label>
                                <input type="file" id="comprobantePago" class="file-upload-input" accept="image/*,.pdf" required>
                            </div>
                            <div class="validation-message" id="validComprobantePago"></div>
                        </div>
                    </div>
                </div>

                <!-- Paso 2: Información Personal -->
                <div class="form-step" data-step="2">
                    <h2 class="step-title">Información Personal del Inquilino</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Tipo de Documento <span class="required">*</span></label>
                            <select id="tipoDocumento" required>
                                <option value="">Seleccione...</option>
                                <option value="CC">Cédula de Ciudadanía</option>
                                <option value="CE">Cédula de Extranjería</option>
                                <option value="PA">Pasaporte</option>
                                <option value="NIT">NIT</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Número de Documento <span class="required">*</span></label>
                            <input type="text" id="numeroDocumento" placeholder="Ej: 1234567890" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Confirmar Número de Documento <span class="required">*</span></label>
                            <input type="text" id="confirmarDocumento" placeholder="Confirme el número" required>
                            <div class="validation-message" id="documentoMatch"></div>
                        </div>
                        
                        <div class="form-group">
                            <label>Fecha de Expedición</label>
                            <input type="date" id="fechaExpedicion">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombres Completos <span class="required">*</span></label>
                            <input type="text" id="nombres" placeholder="Ej: Juan Carlos" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Apellidos Completos <span class="required">*</span></label>
                            <input type="text" id="apellidos" placeholder="Ej: García López" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Correo Electrónico <span class="required">*</span></label>
                            <input type="email" id="email" placeholder="correo@ejemplo.com" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Confirmar Correo <span class="required">*</span></label>
                            <input type="email" id="confirmarEmail" placeholder="Confirme el correo" required>
                            <div class="validation-message" id="emailMatch"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Celular <span class="required">*</span></label>
                            <input type="tel" id="celular" placeholder="Ej: 3001234567" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Confirmar Celular <span class="required">*</span></label>
                            <input type="tel" id="confirmarCelular" placeholder="Confirme el celular" required>
                            <div class="validation-message" id="celularMatch"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ocupación/Profesión <span class="required">*</span></label>
                        <input type="text" id="ocupacion" placeholder="Ej: Ingeniero, Comerciante, etc." required>
                    </div>
                </div>

                <!-- Paso 3: Documentos del Inquilino -->
                <div class="form-step" data-step="3">
                    <h2 class="step-title">Documentos de Identidad</h2>
                    
                    <div class="form-group">
                        <label>Documento de Identidad (Ambas caras) <span class="required">*</span></label>
                        <div class="file-upload-wrapper">
                            <label class="file-upload-label" for="docIdentidad" id="labelDocIdentidad">
                                Seleccionar archivo - Ambas caras del documento
                            </label>
                            <input type="file" id="docIdentidad" class="file-upload-input" accept="image/*,.pdf" multiple required>
                        </div>
                        <div class="validation-message" id="validDocIdentidad"></div>
                    </div>
                </div>

                <!-- Paso 4: Codeudores -->
                <div class="form-step" data-step="4">
                    <h2 class="step-title">Información de Codeudores</h2>
                    
                    <div class="form-group">
                        <label>¿Tiene codeudores?</label>
                        <select id="tieneCodeudores" onchange="toggleCodeudores()">
                            <option value="no">No</option>
                            <option value="si">Sí</option>
                        </select>
                    </div>
                    
                    <div id="codeudoresContainer" style="display: none;">
                        <div class="form-group">
                            <label>Número de codeudores</label>
                            <select id="numeroCodeudores" onchange="generarCamposCodeudores()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                            </select>
                        </div>
                        
                        <div id="camposCodeudores"></div>
                    </div>
                </div>

                <!-- Paso 5: Confirmación -->
                <div class="form-step" data-step="5">
                    <h2 class="step-title">Confirmación y Envío</h2>
                    
                    <div style="text-align: center; padding: 40px 0;">
                        <div class="success-checkmark" id="successCheckmark">
                            <svg width="80" height="80" viewBox="0 0 80 80">
                                <circle cx="40" cy="40" r="35" fill="none" stroke="#FFD700" stroke-width="3"/>
                                <path d="M25 40 L35 50 L55 30" fill="none" stroke="#FFD700" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        
                        <h3 style="color: var(--gold-primary); margin: 20px 0;">Revise su información</h3>
                        <p style="color: var(--white); margin-bottom: 30px;">
                            Por favor verifique que todos los datos ingresados sean correctos antes de enviar.
                        </p>
                        
                        <div id="resumenFormulario" style="text-align: left; background: var(--black-primary); padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <!-- Se llenará dinámicamente -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navegación -->
            <div class="form-navigation">
                <button type="button" class="btn btn-prev" id="btnPrev" onclick="previousStep()" style="display: none;">
                    Anterior
                </button>
                
                <div style="flex: 1;"></div>
                
                <button type="button" class="btn btn-next" id="btnNext" onclick="nextStep()">
                    Siguiente
                </button>
                
                <button type="button" class="btn btn-submit" id="btnSubmit" onclick="enviarFormulario()" style="display: none;">
                    Enviar Formulario
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Pago -->
    <div id="modalPago" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="cerrarModalPago()">&times;</span>
            
            <div class="modal-header">
                <h2 class="modal-title">Pago de Derechos de Contrato</h2>
                <div class="payment-amount">$60.000 COP</div>
            </div>
            
            <div class="payment-method">
                <h3>Opción 1: Transferencia Nequi</h3>
                <div class="nequi-number" id="nequiNumber">3177623878</div>
                <button class="btn btn-next" onclick="copiarNumero()" style="width: 100%; margin-top: 15px;">
                    Copiar Número
                </button>
            </div>
            
            <div style="text-align: center; color: var(--gray-medium); margin: 20px 0;">
                — O —
            </div>
            
            <div class="payment-method">
                <h3>Opción 2: Pago con Tarjeta</h3>
                <a href="https://checkout.wompi.co/l/uuZ80F" target="_blank" class="btn btn-next" style="width: 100%; display: block; text-align: center; text-decoration: none;">
                    Pagar con Wompi
                </a>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Procesando documentos...</div>
    </div>

    <script src="config.js"></script>
    <script>
        // Variables globales
        let currentStep = 1;
        const totalSteps = 5;
        let codigoRegistro = '';
        let archivosBase64 = {};
        let codeudoresData = [];
        let formData = {};

        // Inicializar
        window.onload = function() {
            console.log('Iniciando Gold Life System - Formulario Premium');
            
            // Obtener código de registro
            const urlParams = new URLSearchParams(window.location.search);
            codigoRegistro = urlParams.get('cdr') || '';
            
            if (!codigoRegistro) {
                alert('Código de registro no válido');
                window.location.href = 'selector.html';
                return;
            }
            
            console.log('Código de registro:', codigoRegistro);
            
            // Crear partículas
            createParticles();
            
            // Configurar validaciones
            configurarValidaciones();
            
            // Configurar archivos
            configurarArchivos();
            
            // Actualizar progress bar
            updateProgressBar();
        };

        // Crear partículas doradas
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Navegación entre pasos
        function nextStep() {
            if (!validateCurrentStep()) {
                return;
            }
            
            if (currentStep < totalSteps) {
                // Marcar paso actual como completado
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('completed');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                
                // Ocultar paso actual
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.remove('active');
                
                // Avanzar al siguiente paso
                currentStep++;
                
                // Mostrar nuevo paso
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                
                // Actualizar botones
                updateButtons();
                
                // Actualizar progress bar
                updateProgressBar();
                
                // Si es el último paso, mostrar resumen
                if (currentStep === totalSteps) {
                    mostrarResumen();
                }
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                // Quitar activo del paso actual
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.remove('active');
                
                // Retroceder
                currentStep--;
                
                // Activar paso anterior
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('completed');
                
                // Actualizar botones
                updateButtons();
                
                // Actualizar progress bar
                updateProgressBar();
            }
        }

        function updateButtons() {
            const btnPrev = document.getElementById('btnPrev');
            const btnNext = document.getElementById('btnNext');
            const btnSubmit = document.getElementById('btnSubmit');
            
            // Mostrar/ocultar botón anterior
            btnPrev.style.display = currentStep === 1 ? 'none' : 'block';
            
            // Mostrar/ocultar botones siguiente/enviar
            if (currentStep === totalSteps) {
                btnNext.style.display = 'none';
                btnSubmit.style.display = 'block';
            } else {
                btnNext.style.display = 'block';
                btnSubmit.style.display = 'none';
            }
        }

        function updateProgressBar() {
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressLineActive').style.width = progress + '%';
        }

        // Validación de pasos
        function validateCurrentStep() {
            switch(currentStep) {
                case 1:
                    if (!archivosBase64.estudioAprobado) {
                        showValidationMessage('validEstudioAprobado', 'Debe cargar el documento de estudio aprobado', 'error');
                        return false;
                    }
                    if (!archivosBase64.comprobantePago) {
                        showValidationMessage('validComprobantePago', 'Debe cargar el comprobante de pago', 'error');
                        return false;
                    }
                    return true;
                    
                case 2:
                    // Validar campos de información personal
                    const campos = ['tipoDocumento', 'numeroDocumento', 'confirmarDocumento', 'nombres', 'apellidos', 'email', 'confirmarEmail', 'celular', 'confirmarCelular', 'ocupacion'];
                    for (const campo of campos) {
                        const elemento = document.getElementById(campo);
                        if (!elemento.value) {
                            elemento.focus();
                            return false;
                        }
                    }
                    
                    // Validar coincidencias
                    if (document.getElementById('numeroDocumento').value !== document.getElementById('confirmarDocumento').value) {
                        showValidationMessage('documentoMatch', 'Los números de documento no coinciden', 'error');
                        return false;
                    }
                    if (document.getElementById('email').value !== document.getElementById('confirmarEmail').value) {
                        showValidationMessage('emailMatch', 'Los correos no coinciden', 'error');
                        return false;
                    }
                    if (document.getElementById('celular').value !== document.getElementById('confirmarCelular').value) {
                        showValidationMessage('celularMatch', 'Los números de celular no coinciden', 'error');
                        return false;
                    }
                    return true;
                    
                case 3:
                    if (!archivosBase64.docIdentidad) {
                        showValidationMessage('validDocIdentidad', 'Debe cargar el documento de identidad', 'error');
                        return false;
                    }
                    return true;
                    
                case 4:
                    // Validar codeudores si aplica
                    if (document.getElementById('tieneCodeudores').value === 'si') {
                        const numCodeudores = parseInt(document.getElementById('numeroCodeudores').value);
                        for (let i = 1; i <= numCodeudores; i++) {
                            const campos = [`tipoDocCodeudor${i}`, `numDocCodeudor${i}`, `nombresCodeudor${i}`, `apellidosCodeudor${i}`, `emailCodeudor${i}`, `celularCodeudor${i}`];
                            for (const campo of campos) {
                                const elemento = document.getElementById(campo);
                                if (elemento && !elemento.value) {
                                    elemento.focus();
                                    return false;
                                }
                            }
                            if (!archivosBase64[`docCodeudor${i}`]) {
                                alert(`Debe cargar el documento del codeudor ${i}`);
                                return false;
                            }
                        }
                    }
                    return true;
                    
                default:
                    return true;
            }
        }

        function showValidationMessage(elementId, message, type) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                element.className = `validation-message show ${type}`;
                setTimeout(() => {
                    element.classList.remove('show');
                }, 5000);
            }
        }

        // Configurar validaciones
        function configurarValidaciones() {
            // Validación de documento
            document.getElementById('confirmarDocumento').addEventListener('input', function() {
                const doc1 = document.getElementById('numeroDocumento').value;
                const doc2 = this.value;
                const match = document.getElementById('documentoMatch');
                
                if (doc2.length > 0) {
                    if (doc1 === doc2) {
                        showValidationMessage('documentoMatch', 'Los documentos coinciden', 'success');
                    } else {
                        showValidationMessage('documentoMatch', 'Los documentos no coinciden', 'error');
                    }
                }
            });
            
            // Validación de email
            document.getElementById('confirmarEmail').addEventListener('input', function() {
                const email1 = document.getElementById('email').value;
                const email2 = this.value;
                
                if (email2.length > 0) {
                    if (email1 === email2) {
                        showValidationMessage('emailMatch', 'Los correos coinciden', 'success');
                    } else {
                        showValidationMessage('emailMatch', 'Los correos no coinciden', 'error');
                    }
                }
            });
            
            // Validación de celular
            document.getElementById('confirmarCelular').addEventListener('input', function() {
                const cel1 = document.getElementById('celular').value;
                const cel2 = this.value;
                
                if (cel2.length > 0) {
                    if (cel1 === cel2) {
                        showValidationMessage('celularMatch', 'Los celulares coinciden', 'success');
                    } else {
                        showValidationMessage('celularMatch', 'Los celulares no coinciden', 'error');
                    }
                }
            });
        }

        // Configurar archivos
        function configurarArchivos() {
            const fileInputs = document.querySelectorAll('.file-upload-input');
            fileInputs.forEach(input => {
                input.addEventListener('change', function() {
                    const label = document.getElementById('label' + this.id.charAt(0).toUpperCase() + this.id.slice(1));
                    if (this.files.length > 0) {
                        label.textContent = this.files[0].name;
                        label.classList.add('file-selected');
                        convertirArchivoBase64(this);
                    }
                });
            });
        }

        // Convertir archivo a Base64
        function convertirArchivoBase64(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                archivosBase64[input.id] = {
                    nombre: file.name,
                    tipo: file.type,
                    contenido: e.target.result
                };
                console.log(`Archivo ${input.id} convertido a Base64`);
            };
            reader.readAsDataURL(file);
        }

        // Modal de pago
        function mostrarModalPago() {
            document.getElementById('modalPago').classList.add('show');
        }

        function cerrarModalPago() {
            document.getElementById('modalPago').classList.remove('show');
        }

        function copiarNumero() {
            const numero = '3177623878';
            
            // Crear elemento temporal
            const tempInput = document.createElement('input');
            tempInput.style.position = 'absolute';
            tempInput.style.left = '-9999px';
            tempInput.value = numero;
            document.body.appendChild(tempInput);
            
            // Seleccionar y copiar
            tempInput.select();
            tempInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                event.target.textContent = 'Número Copiado';
                event.target.style.background = 'var(--success)';
                
                setTimeout(() => {
                    event.target.textContent = 'Copiar Número';
                    event.target.style.background = '';
                    cerrarModalPago();
                }, 1500);
            } catch (err) {
                alert('Número: ' + numero);
            }
            
            document.body.removeChild(tempInput);
        }

        // Toggle codeudores
        function toggleCodeudores() {
            const tiene = document.getElementById('tieneCodeudores').value;
            const container = document.getElementById('codeudoresContainer');
            
            if (tiene === 'si') {
                container.style.display = 'block';
                generarCamposCodeudores();
            } else {
                container.style.display = 'none';
                codeudoresData = [];
            }
        }

        // Generar campos de codeudores
        function generarCamposCodeudores() {
            const numero = parseInt(document.getElementById('numeroCodeudores').value);
            const container = document.getElementById('camposCodeudores');
            container.innerHTML = '';
            codeudoresData = [];
            
            for (let i = 1; i <= numero; i++) {
                const codeudorHtml = `
                    <div class="codeudor-section">
                        <h3 class="codeudor-header">Codeudor ${i}</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tipo de Documento <span class="required">*</span></label>
                                <select id="tipoDocCodeudor${i}" required>
                                    <option value="">Seleccione...</option>
                                    <option value="CC">Cédula de Ciudadanía</option>
                                    <option value="CE">Cédula de Extranjería</option>
                                    <option value="PA">Pasaporte</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>Número de Documento <span class="required">*</span></label>
                                <input type="text" id="numDocCodeudor${i}" placeholder="Número de documento" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nombres <span class="required">*</span></label>
                                <input type="text" id="nombresCodeudor${i}" placeholder="Nombres completos" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Apellidos <span class="required">*</span></label>
                                <input type="text" id="apellidosCodeudor${i}" placeholder="Apellidos completos" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email <span class="required">*</span></label>
                                <input type="email" id="emailCodeudor${i}" placeholder="correo@ejemplo.com" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Celular <span class="required">*</span></label>
                                <input type="tel" id="celularCodeudor${i}" placeholder="3001234567" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Documento de Identidad <span class="required">*</span></label>
                            <div class="file-upload-wrapper">
                                <label class="file-upload-label" for="docCodeudor${i}" id="labelDocCodeudor${i}">
                                    Seleccionar archivo - Ambas caras
                                </label>
                                <input type="file" id="docCodeudor${i}" class="file-upload-input" accept="image/*,.pdf" required onchange="handleCodeudorFile(this, ${i})">
                            </div>
                        </div>
                    </div>
                `;
                
                container.innerHTML += codeudorHtml;
            }
        }

        function handleCodeudorFile(input, index) {
            const label = document.getElementById(`labelDocCodeudor${index}`);
            if (input.files.length > 0) {
                label.textContent = input.files[0].name;
                label.classList.add('file-selected');
                convertirArchivoBase64(input);
            }
        }

        // Mostrar resumen
        function mostrarResumen() {
            const resumen = document.getElementById('resumenFormulario');
            
            const nombre = document.getElementById('nombres').value + ' ' + document.getElementById('apellidos').value;
            const documento = document.getElementById('tipoDocumento').value + ' ' + document.getElementById('numeroDocumento').value;
            const email = document.getElementById('email').value;
            const celular = document.getElementById('celular').value;
            
            let resumenHTML = `
                <div style="color: var(--gold-light);">
                    <p><strong>Nombre:</strong> ${nombre}</p>
                    <p><strong>Documento:</strong> ${documento}</p>
                    <p><strong>Email:</strong> ${email}</p>
                    <p><strong>Celular:</strong> ${celular}</p>
                    <p><strong>Ocupación:</strong> ${document.getElementById('ocupacion').value}</p>
                    <p><strong>Codeudores:</strong> ${document.getElementById('tieneCodeudores').value === 'si' ? document.getElementById('numeroCodeudores').value : 'No'}</p>
                </div>
            `;
            
            resumen.innerHTML = resumenHTML;
            
            // Mostrar checkmark
            document.getElementById('successCheckmark').classList.add('show');
        }

        // Enviar formulario
        async function enviarFormulario() {
            console.log('Enviando formulario...');
            
            // Mostrar loading
            document.getElementById('loadingOverlay').classList.add('show');
            
            // Recopilar datos
            const datosFormulario = {
                codigoRegistro: codigoRegistro,
                inquilino: {
                    tipoDocumento: document.getElementById('tipoDocumento').value,
                    numeroDocumento: document.getElementById('numeroDocumento').value,
                    fechaExpedicion: document.getElementById('fechaExpedicion').value,
                    nombre: document.getElementById('nombres').value + ' ' + document.getElementById('apellidos').value,
                    nombres: document.getElementById('nombres').value,
                    apellidos: document.getElementById('apellidos').value,
                    email: document.getElementById('email').value,
                    celular: document.getElementById('celular').value,
                    ocupacion: document.getElementById('ocupacion').value
                },
                tieneCodeudores: document.getElementById('tieneCodeudores').value,
                codeudores: []
            };
            
            // Agregar codeudores si existen
            if (datosFormulario.tieneCodeudores === 'si') {
                const numCodeudores = parseInt(document.getElementById('numeroCodeudores').value);
                
                for (let i = 1; i <= numCodeudores; i++) {
                    const codeudor = {
                        tipoDocumento: document.getElementById(`tipoDocCodeudor${i}`).value,
                        numeroDocumento: document.getElementById(`numDocCodeudor${i}`).value,
                        nombre: document.getElementById(`nombresCodeudor${i}`).value + ' ' + 
                               document.getElementById(`apellidosCodeudor${i}`).value,
                        nombres: document.getElementById(`nombresCodeudor${i}`).value,
                        apellidos: document.getElementById(`apellidosCodeudor${i}`).value,
                        email: document.getElementById(`emailCodeudor${i}`).value,
                        celular: document.getElementById(`celularCodeudor${i}`).value
                    };
                    datosFormulario.codeudores.push(codeudor);
                }
            }
            
            console.log('Datos a enviar:', datosFormulario);
            
            try {
                const response = await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: JSON.stringify({
                        accion: 'procesarFormularioInquilino',
                        datosFormulario: datosFormulario,
                        archivosBase64: archivosBase64
                    })
                });
                
                // Asumir éxito con no-cors
                console.log('Formulario enviado exitosamente');
                
                // Redirigir a página de éxito
                setTimeout(() => {
                    window.location.href = `pagina-exito.html?estado=exitoso&cdr=${encodeURIComponent(codigoRegistro)}`;
                }, 2000);
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loadingOverlay').classList.remove('show');
                alert('Error al enviar el formulario. Por favor intente nuevamente.');
            }
        }
    </script>
</body>
</html>
